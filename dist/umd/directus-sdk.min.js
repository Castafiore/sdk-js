!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).Directus={})}(this,function(u){"use strict";var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)};var s=function(){return(s=Object.assign||function(t){for(var e,o=1,r=arguments.length;o<r;o++)for(var n in e=arguments[o])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)};function t(i,s,a,u){return new(a=a||Promise)(function(t,e){function o(t){try{n(u.next(t))}catch(t){e(t)}}function r(t){try{n(u.throw(t))}catch(t){e(t)}}function n(e){e.done?t(e.value):new a(function(t){t(e.value)}).then(o,r)}n((u=u.apply(i,s||[])).next())})}function n(o,r){var n,i,s,t,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(s=2&e[0]?i.return:e[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,e[1])).done)return s;switch(i=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,i=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}s[2]&&a.ops.pop(),a.trys.pop();continue}e=r.call(o,a)}catch(t){e=[6,t],i=0}finally{n=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}var r="directus-sdk-js",e=(Object.defineProperty(a.prototype,"token",{get:function(){return this.internalConfiguration.token},set:function(t){this.partialUpdate({token:t})},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"tokenExpirationTime",{get:function(){return this.internalConfiguration.tokenExpirationTime},set:function(t){this.partialUpdate({tokenExpirationTime:6e4*t})},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"url",{get:function(){return this.internalConfiguration.url},set:function(t){this.partialUpdate({url:t})},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"project",{get:function(){return this.internalConfiguration.project},set:function(t){this.partialUpdate({project:t||"_"})},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"localExp",{get:function(){return this.internalConfiguration.localExp},set:function(t){this.partialUpdate({localExp:t})},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"persist",{get:function(){return this.internalConfiguration.persist},set:function(t){this.internalConfiguration.persist=t},enumerable:!0,configurable:!0}),a.prototype.update=function(t){this.internalConfiguration=t,this.hydrate(t)},a.prototype.partialUpdate=function(t){this.internalConfiguration=s({},this.internalConfiguration,t),this.hydrate(this.internalConfiguration)},a.prototype.reset=function(){delete this.internalConfiguration.token,delete this.internalConfiguration.url,delete this.internalConfiguration.localExp,this.internalConfiguration.project="_",this.deleteHydratedConfig()},a.prototype.dehydrate=function(){if(this.storage&&this.persist){var t=this.storage.getItem(r);if(t){var e=JSON.parse(t);return this.internalConfiguration=e}}},a.prototype.hydrate=function(t){this.storage&&this.persist&&this.storage.setItem(r,JSON.stringify(t))},a.prototype.deleteHydratedConfig=function(){this.storage&&this.persist&&this.storage.removeItem(r)},a.prototype.dehydratedInitialConfiguration=function(t){if(!t)return{};var e=t.getItem(r);if(e)try{return JSON.parse(e)}catch(t){return{}}},a.defaults={project:"_",tokenExpirationTime:3e4},a);function a(t,e){void 0===t&&(t={});var o={};(this.storage=e)&&Boolean(t&&t.persist)&&(o=this.dehydratedInitialConfiguration(e));var r=Boolean(o.persist||t.persist),n=o.project||t.project||a.defaults.project,i=o.tokenExpirationTime||t.tokenExpirationTime||a.defaults.tokenExpirationTime;this.internalConfiguration=s({},t,o,{persist:r,project:n,tokenExpirationTime:i})}function i(t){return t.startsWith("directus_")?"/"+t.substr(9):"/items/"+t}!function(t){var e="object"==typeof u&&u,o="object"==typeof module&&module&&module.exports==e&&module,r="object"==typeof global&&global;r.global!==r&&r.window!==r||(t=r);function n(t){this.message=t}(n.prototype=new Error).name="InvalidCharacterError";function p(t){throw new n(t)}var c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=/[\t\n\f\r ]/g,i={encode:function(t){t=String(t),/[^\0-\xFF]/.test(t)&&p("The string to be encoded contains characters outside of the Latin1 range.");for(var e,o,r,n,i=t.length%3,s="",a=-1,u=t.length-i;++a<u;)e=t.charCodeAt(a)<<16,o=t.charCodeAt(++a)<<8,r=t.charCodeAt(++a),s+=c.charAt((n=e+o+r)>>18&63)+c.charAt(n>>12&63)+c.charAt(n>>6&63)+c.charAt(63&n);return 2==i?(e=t.charCodeAt(a)<<8,o=t.charCodeAt(++a),s+=c.charAt((n=e+o)>>10)+c.charAt(n>>4&63)+c.charAt(n<<2&63)+"="):1==i&&(n=t.charCodeAt(a),s+=c.charAt(n>>2)+c.charAt(n<<4&63)+"=="),s},decode:function(t){var e=(t=String(t).replace(a,"")).length;e%4==0&&(e=(t=t.replace(/==?$/,"")).length),e%4!=1&&!/[^+a-zA-Z0-9/]/.test(t)||p("Invalid character: the string to be decoded is not correctly encoded.");for(var o,r,n=0,i="",s=-1;++s<e;)r=c.indexOf(t.charAt(s)),o=n%4?64*o+r:r,n++%4&&(i+=String.fromCharCode(255&o>>(-2*n&6)));return i},version:"0.1.0"};if("function"==typeof define&&"object"==typeof define.amd&&define.amd)define(function(){return i});else if(e&&!e.nodeType)if(o)o.exports=i;else for(var s in i)i.hasOwnProperty(s)&&(e[s]=i[s]);else t.base64=i}(void 0);function p(t,e){return Object.prototype.toString.call(e)==="[object "+t+"]"}function c(t){return t&&"string"==typeof t&&/\S/.test(t)}function l(t){return t instanceof Function}function f(t){if(!function(t){return p("Object",t)}(t))return!1;for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!0;return!1}function h(t){if(!t||t.length<0||t.split(".").length<=0)return{};try{var e=(void 0)(t.split(".")[1].replace("-","+").replace("_","/")),o=JSON.parse(e);return function(t){return p("Number",t)&&isFinite(t)&&!isNaN(parseFloat(t))}(o.exp)&&(o.exp=new Date(1e3*o.exp)),o}catch(t){return{}}}var d=(g.prototype.isLoggedIn=function(){return!!(c(this.config.token)&&c(this.config.url)&&c(this.config.project)&&f(this.getPayload())&&this.config.localExp>Date.now())},g.prototype.login=function(o,t){var r=this;return this.config.token=null,c(o.url)&&(this.config.url=o.url),c(o.project)&&(this.config.project=o.project),(o.persist||t&&t.persist||this.config.persist)&&this.startInterval(),new Promise(function(e,t){r.inject.post("/auth/authenticate",{email:o.email,password:o.password}).then(function(t){return r.config.token=t.data.token}).then(function(t){r.config.localExp=new Date(Date.now()+r.config.tokenExpirationTime).getTime(),e({localExp:r.config.localExp,project:r.config.project,token:t,url:r.config.url})}).catch(t)})},g.prototype.logout=function(){this.config.reset(),this.refreshInterval&&this.stopInterval()},g.prototype.refreshIfNeeded=function(){var o=this,t=this.getPayload(),e=this.config,r=e.token,n=e.url,i=e.project,s=e.localExp;if(c(r)&&c(n)&&c(i)&&t&&t.exp){var a=(s||0)-Date.now();if(!(a<=0))return a<3e4?new Promise(function(e){o.refresh(r).then(function(t){o.config.localExp=new Date(Date.now()+o.config.tokenExpirationTime).getTime(),o.config.token=t.data.token||r,l(o.onAutoRefreshSuccess)&&o.onAutoRefreshSuccess(o.config),e([!0])}).catch(function(t){l(o.onAutoRefreshError)&&o.onAutoRefreshError(t),e([!0,t])})}):void 0;l(this.onAutoRefreshError)&&this.onAutoRefreshError({code:102,message:"auth_expired_token"})}},g.prototype.refresh=function(t){return this.inject.post("/auth/refresh",{token:t})},g.prototype.startInterval=function(t){t&&this.refreshIfNeeded(),this.refreshInterval=setInterval(this.refreshIfNeeded.bind(this),1e4)},g.prototype.stopInterval=function(){clearInterval(this.refreshInterval),this.refreshInterval=null},g.prototype.getPayload=function(){return c(this.config.token)?h(this.config.token):null},g);function g(t,e){this.config=t,this.inject=e,t.token&&t.token.includes(".")&&this.startInterval(!0)}var y=function(t,e){return t+"="+e};function v(r){return t(this,void 0,void 0,function(){var e,o;return n(this,function(t){switch(t.label){case 0:if(!r)throw new Error("Invalid request options: "+r);return e=r.url,r.baseURL&&(e=r.baseURL+"/"+e),r.params&&(e=e+"?"+function t(e,o,r){void 0===r&&(r=y);var n,i=[];for(n in e)if(e.hasOwnProperty(n)){var s=o?o+"["+n+"]":n,a=e[n];i.push(null!==a&&"object"==typeof a?t(a,s):r(s,a))}return i.join("")}(r.params)),r.body&&"string"!=typeof r.body&&(r.body=JSON.stringify(r.body)),[4,function(t,o){return Promise.race([t(),new Promise(function(t,e){setTimeout(function(){return e(new Error("Timeout of "+o+" reached"))},o)})])}(function(){return fetch(e,{method:r.method,body:r.body,headers:r.headers,credentials:r.credentials||"omit"})},r.timeout||2e3)];case 1:return o=t.sent(),r&&r.skipToJSON?[4,o.text()]:[3,3];case 2:return[2,t.sent()];case 3:return[4,o.json()];case 4:return[2,t.sent()]}})})}"undefined"!=typeof module&&module.exports||require("whatwg-fetch");var m,b,j;j=Error,o(m=I,b=j),m.prototype=null===b?Object.create(b):(P.prototype=b.prototype,new P),Object.defineProperty(I.prototype,"url",{get:function(){return this.info.url},enumerable:!0,configurable:!0}),Object.defineProperty(I.prototype,"method",{get:function(){return this.info.method.toUpperCase()},enumerable:!0,configurable:!0}),Object.defineProperty(I.prototype,"code",{get:function(){return""+(this.info.code||-1)},enumerable:!0,configurable:!0}),Object.defineProperty(I.prototype,"params",{get:function(){return this.info.params||{}},enumerable:!0,configurable:!0}),I.prototype.toString=function(){return["Directus call failed:",this.method+" "+this.url+" "+JSON.stringify(this.params)+" -",this.message,"(code "+this.code+")"].join(" ")};function P(){this.constructor=m}function I(t,e){var o=this.constructor,r=j.call(this,t)||this;return r.message=t,r.info=e,Object.setPrototypeOf(r,o.prototype),r}var k=(w.prototype.reset=function(){this.auth.logout(),this.config.deleteHydratedConfig()},w.prototype.get=function(t,e){return void 0===e&&(e={}),this.request("get",t,e)},w.prototype.post=function(t,e,o){return void 0===e&&(e={}),void 0===o&&(o={}),this.request("post",t,o,e)},w.prototype.patch=function(t,e,o){return void 0===e&&(e={}),void 0===o&&(o={}),this.request("patch",t,o,e)},w.prototype.put=function(t,e,o){return void 0===e&&(e={}),void 0===o&&(o={}),this.request("put",t,o,e)},w.prototype.delete=function(t){return this.request("delete",t)},w.prototype.getPayload=function(){return c(this.config.token)?h(this.config.token):null},w.prototype.request=function(t,e,o,r,n,i,s){if(void 0===o&&(o={}),void 0===r&&(r={}),void 0===n&&(n=!1),void 0===i&&(i={}),void 0===s&&(s=!1),!this.config.url)throw new Error("API has no URL configured to send requests to, please check the docs.");var a=this.config.url+"/";return!1===n&&(a+=this.config.project+"/"),this.config.token&&c(this.config.token)&&0<this.config.token.length&&(i.Authorization="Bearer "+this.config.token),this.fetch({method:t,url:e,body:r,baseURL:a,headers:i,params:o,skipToJSON:s})},w);function w(t){this.config=t,this.fetch=v,this.auth=new d(t,{post:this.post.bind(this)})}var C=(Object.defineProperty(x.prototype,"loggedIn",{get:function(){return this.api.auth.isLoggedIn()},enumerable:!0,configurable:!0}),Object.defineProperty(x.prototype,"payload",{get:function(){return this.config.token?this.api.getPayload():null},enumerable:!0,configurable:!0}),x.prototype.login=function(t,e){return this.api.auth.login(t,e)},x.prototype.logout=function(){this.api.auth.logout()},x.prototype.reset=function(){this.api.reset()},x.prototype.refreshIfNeeded=function(){return this.api.auth.refreshIfNeeded()},x.prototype.refresh=function(t){return this.api.auth.refresh(t)},x.prototype.requestPasswordReset=function(t){return this.api.post("/auth/password/request",{email:t})},x.prototype.getActivity=function(t){return void 0===t&&(t={}),this.api.get("/activity",t)},x.prototype.getMyBookmarks=function(t){return void 0===t&&(t={}),this.getCollectionPresets(t)},x.prototype.getCollections=function(t){return void 0===t&&(t={}),this.api.get("/collections",t)},x.prototype.getCollection=function(t,e){return void 0===e&&(e={}),this.api.get("/collections/"+t,e)},x.prototype.createCollection=function(t){return this.api.post("/collections",t)},x.prototype.updateCollection=function(t,e){return this.api.patch("/collections/"+t,e)},x.prototype.deleteCollection=function(t){return this.api.delete("/collections/"+t)},x.prototype.getCollectionPresets=function(t){var e=this.api.getPayload();return Promise.all([this.api.get("/collection_presets",{"filter[title][nnull]":1,"filter[user][eq]":e.id}),this.api.get("/collection_presets",{"filter[role][eq]":e.role,"filter[title][nnull]":1,"filter[user][null]":1})]).then(function(t){var e=t[0],o=t[1];return(e.data||[]).concat(o.data||[])})},x.prototype.createCollectionPreset=function(t){return this.api.post("/collection_presets",t)},x.prototype.updateCollectionPreset=function(t,e){return this.api.patch("/collection_presets/"+t,e)},x.prototype.deleteCollectionPreset=function(t){return this.api.delete("/collection_presets/"+t)},x.prototype.getInterfaces=function(){return this.api.request("get","/interfaces",{},{},!0)},x.prototype.getLayouts=function(){return this.api.request("get","/layouts",{},{},!0)},x.prototype.getPages=function(){return this.api.request("get","/pages",{},{},!0)},x.prototype.getAllFields=function(t){return void 0===t&&(t={}),this.api.get("/fields",t)},x.prototype.getFields=function(t,e){return void 0===e&&(e={}),this.api.get("/fields/"+t,e)},x.prototype.getField=function(t,e,o){return void 0===o&&(o={}),this.api.get("/fields/"+t+"/"+e,o)},x.prototype.createField=function(t,e){return this.api.post("/fields/"+t,e)},x.prototype.updateField=function(t,e,o){return this.api.patch("/fields/"+t+"/"+e,o)},x.prototype.updateFields=function(t,e,o){return void 0===o&&(o=null),o?this.api.patch("/fields/"+t+"/"+e.join(","),o):this.api.patch("/fields/"+t,e)},x.prototype.deleteField=function(t,e){return this.api.delete("/fields/"+t+"/"+e)},x.prototype.getFiles=function(e){return void 0===e&&(e={}),t(this,void 0,void 0,function(){return n(this,function(t){return[2,this.api.get("/files",e)]})})},x.prototype.getFile=function(o,r){return void 0===r&&(r={}),t(this,void 0,void 0,function(){var e;return n(this,function(t){return e="string"==typeof o?o:o.join(","),[2,this.api.get("/files/"+e,r)]})})},x.prototype.uploadFiles=function(t,e){var o={Authorization:"Bearer "+this.config.token,"Content-Type":"multipart/form-data"};return v({method:"post",url:this.config.url+"/"+this.config.project+"/files",body:t,headers:o})},x.prototype.updateItem=function(t,e,o,r){void 0===r&&(r={});var n=i(t);return this.api.patch(n+"/"+e,o,r)},x.prototype.updateItems=function(t,e,o){void 0===o&&(o={});var r=i(t);return this.api.patch(r,e,o)},x.prototype.createItem=function(t,e){var o=i(t);return this.api.post(o,e)},x.prototype.createItems=function(t,e){var o=i(t);return this.api.post(o,e)},x.prototype.getItems=function(t,e){void 0===e&&(e={});var o=i(t);return this.api.get(o,e)},x.prototype.getItem=function(t,e,o){void 0===o&&(o={});var r=i(t);return this.api.get(r+"/"+e,o)},x.prototype.deleteItem=function(t,e){var o=i(t);return this.api.delete(o+"/"+e)},x.prototype.deleteItems=function(t,e){var o=i(t);return this.api.delete(o+"/"+e.join())},x.prototype.getMyListingPreferences=function(t,e){var o=this.api.getPayload();return Promise.all([this.api.get("/collection_presets",{"filter[collection][eq]":t,"filter[role][null]":1,"filter[title][null]":1,"filter[user][null]":1,limit:1,sort:"-id"}),this.api.get("/collection_presets",{"filter[collection][eq]":t,"filter[role][eq]":o.role,"filter[title][null]":1,"filter[user][null]":1,limit:1,sort:"-id"}),this.api.get("/collection_presets",{"filter[collection][eq]":t,"filter[role][eq]":o.role,"filter[title][null]":1,"filter[user][eq]":o.id,limit:1,sort:"-id"})]).then(function(t){var e=t[0],o=t[1],r=t[2];return r.data&&0<r.data.length?r.data[0]:o.data&&0<o.data.length?o.data[0]:e.data&&0<e.data.length?e.data[0]:{}})},x.prototype.getPermissions=function(t){return void 0===t&&(t={}),this.getItems("directus_permissions",t)},x.prototype.getMyPermissions=function(t){return void 0===t&&(t={}),this.api.get("/permissions/me",t)},x.prototype.createPermissions=function(t){return this.api.post("/permissions",t)},x.prototype.updatePermissions=function(t){return this.api.patch("/permissions",t)},x.prototype.getRelations=function(t){return void 0===t&&(t={}),this.api.get("/relations",t)},x.prototype.createRelation=function(t){return this.api.post("/relations",t)},x.prototype.updateRelation=function(t,e){return this.api.patch("/relations/"+t,e)},x.prototype.getCollectionRelations=function(t,e){return Promise.all([this.api.get("/relations",{"filter[collection_a][eq]":t}),this.api.get("/relations",{"filter[collection_b][eq]":t})])},x.prototype.getItemRevisions=function(t,e,o){void 0===o&&(o={});var r=i(t);return this.api.get(r+"/"+e+"/revisions",o)},x.prototype.revert=function(t,e,o){var r=i(t);return this.api.patch(r+"/"+e+"/revert/"+o)},x.prototype.getRole=function(t,e){return void 0===e&&(e={}),this.api.get("/roles/"+t,e)},x.prototype.getRoles=function(t){return void 0===t&&(t={}),this.api.get("/roles",t)},x.prototype.updateRole=function(t,e){return this.updateItem("directus_roles",t,e)},x.prototype.createRole=function(t){return this.createItem("directus_roles",t)},x.prototype.deleteRole=function(t){return this.deleteItem("directus_roles",t)},x.prototype.getSettings=function(t){return void 0===t&&(t={}),this.api.get("/settings",t)},x.prototype.getSettingsFields=function(t){return void 0===t&&(t={}),this.api.get("/settings/fields",t)},x.prototype.getUsers=function(t){return void 0===t&&(t={}),this.api.get("/users",t)},x.prototype.getUser=function(t,e){return void 0===e&&(e={}),this.api.get("/users/"+t,e)},x.prototype.getMe=function(t){return void 0===t&&(t={}),this.api.get("/users/me",t)},x.prototype.updateUser=function(t,e){return this.updateItem("directus_users",t,e)},x.prototype.updateDatabase=function(){return this.api.post("/update")},x.prototype.ping=function(){return this.api.request("get","/server/ping",{},{},!0,{},!0)},x.prototype.serverInfo=function(){return this.api.request("get","/",{},{},!0)},x.prototype.projectInfo=function(){return this.api.request("get","/")},x.prototype.getThirdPartyAuthProviders=function(){return this.api.get("/auth/sso")},x.getPayload=h,x);function x(t){this.config=new e(t),this.api=new k(this.config)}u.Configuration=e,u.SDK=C,u.default=C,u.getCollectionItemPath=i,u.getPayload=h,Object.defineProperty(u,"__esModule",{value:!0})});